---
import { Image } from "@astrojs/image/components";
import { projects } from "../content/projects.json";
---

<script>
  import showElementOnScroll from "../utils/showElementOnScroll";
  import { isProjectsVisible, isSkillsVisible } from "../utils/store";
  const div = document.querySelector("#projects") as Element;
  isProjectsVisible.listen((isVisible) => {
    if (isVisible) {
      div.classList.add("anim");
    }
  });
  showElementOnScroll(isSkillsVisible, div, 0.3);
</script>
<div id="projects">
  <h2 class="title-gradient">Projets</h2>
  <div class="wrapper">
    {
      projects.map((project) => (
        <div class="projet">
          <div class="placeholder">
            <Image
              src={project.preview}
              alt={`image du site ${project.title}`}
              width="400px"
              height="225px"
              quality={100}
              loading="lazy"
            />
          </div>
          <div class="text">
            <h3>{project.title}</h3>
            <p>{project.description}</p>
            <p>{project.lastSentence}</p>
            <div class="links">
              <a
                href={project.links.website}
                title={`Lien vers le site ${project.title}`}
                target="_blank"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                  fill="#000000"
                  height="800px"
                  width="800px"
                  version="1.1"
                  id="Layer_1"
                  viewBox="0 0 512 512"
                  xml:space="preserve"
                >
                  <g>
                    <g>
                      <path d="M256,0C114.842,0,0,114.842,0,256s114.842,256,256,256s256-114.842,256-256S397.158,0,256,0z M194.27,34.43    c-10.879,10.942-20.817,25.328-29.403,43.945c-6.558,14.217-12.228,30.589-16.964,46.343H67.21    C97.373,81.395,142.101,49,194.27,34.43z M51.43,150.974h89.971c-6.111,28.882-9.67,60.39-10.408,91.897H26.607    C28.398,210.051,37.15,179.856,51.43,150.974z M26.673,269.128h104.35c0.8,32.82,4.418,64.328,10.6,91.897H51.98    C37.534,333.456,28.614,303.262,26.673,269.128z M67.933,387.282h80.266c4.676,17.067,10.245,31.772,16.666,45.693    c8.413,18.238,18.206,32.647,28.936,43.817C142.251,462.276,97.995,430.605,67.933,387.282z M242.872,483.601    c-24.944-8.623-51.007-42.493-67.465-96.319h67.465V483.601z M242.872,361.026H168.34c-6.236-26.256-10.214-57.764-11.062-91.897    h85.593V361.026z M242.872,242.872h-85.613c0.776-31.508,4.54-63.015,11.001-91.897h74.612V242.872z M242.872,124.718H175.26    c3.898-11.815,8.174-24.25,13.232-35.216c15.353-33.288,34.687-54.59,54.38-61.13V124.718z M485.393,242.872H381.007    c-0.738-31.508-4.296-63.015-10.408-91.897h89.971C474.85,179.856,483.602,210.051,485.393,242.872z M444.79,124.718h-80.693    c-4.737-15.754-10.405-31.996-16.963-46.213c-8.524-18.481-18.091-33.049-28.51-43.962    C370.411,49.232,414.799,82.708,444.79,124.718z M269.128,28.652c19.692,6.875,38.816,28.047,53.946,60.849    c5.058,10.966,9.767,23.401,13.665,35.216h-67.612V28.652z M269.128,150.974h74.612c6.46,28.882,10.226,60.39,11.001,91.897    h-85.613V150.974z M269.128,269.128h85.593c-0.848,34.133-4.826,65.641-11.062,91.897h-74.531V269.128z M269.128,483.316v-96.034    h67.465C320.319,439.795,295.385,474.221,269.128,483.316z M319.588,476.525c10.013-11.117,19.234-25.659,27.546-43.68    c6.421-13.921,11.99-28.496,16.666-45.563h80.266C414.275,430.605,370.545,461.827,319.588,476.525z M460.02,361.026h-89.642    c6.181-27.569,9.8-59.077,10.6-91.897h104.35C483.386,303.262,474.466,333.456,460.02,361.026z" />
                    </g>
                  </g>
                </svg>
              </a>
              <a
                href={project.links.github}
                target="_blank"
                title={`Lien vers le repository github du site ${project.title}`}
              >
                <svg
                  enable-background="new 0 0 32 32"
                  version="1.1"
                  viewBox="0 0 32 32"
                  xml:space="preserve"
                  xmlns="http://www.w3.org/2000/svg"
                  xmlns:xlink="http://www.w3.org/1999/xlink"
                >
                  <g id="Github">
                    <path d="M15.737,31C7.474,31,1,24.411,1,16c0-3.629,1.238-7.111,3.485-9.804c0.176-0.212,0.493-0.241,0.704-0.063   C5.401,6.31,5.43,6.625,5.253,6.837C3.155,9.35,2,12.604,2,16c0,7.851,6.034,14,13.737,14C23.602,30,30,23.72,30,16   S23.602,2,15.737,2c-2.441,0-4.812,0.62-6.858,1.792C8.641,3.927,8.334,3.845,8.197,3.606C8.06,3.366,8.143,3.061,8.382,2.923   C10.579,1.665,13.123,1,15.737,1C24.153,1,31,7.729,31,16S24.153,31,15.737,31z" />
                    <path d="M11.393,30.176c-0.171,0-0.342-0.029-0.506-0.089C4.695,27.841,0.728,21.911,1.015,15.33   c0.012-0.275,0.232-0.485,0.521-0.478c0.276,0.012,0.49,0.246,0.478,0.521c-0.268,6.142,3.435,11.677,9.214,13.772   c0.151,0.056,0.318,0.033,0.453-0.063c0.139-0.098,0.218-0.25,0.217-0.417l-0.008-1.573c-3.927,0.561-4.857-2.375-4.867-2.406   c-0.552-1.405-1.342-1.82-1.35-1.824c-0.342-0.229-0.996-0.676-0.81-1.262c0.167-0.528,0.852-0.563,1.136-0.572   c1.736,0.122,2.616,1.693,2.652,1.76c0.956,1.643,2.414,1.446,3.335,1.094c0.09-0.452,0.239-0.863,0.439-1.216   c-2.872-0.486-6.176-1.973-6.176-7.568c0-1.531,0.479-2.88,1.424-4.016C7.465,10.408,7.205,8.97,7.917,7.157   C7.972,7.017,8.087,6.91,8.23,6.864C8.374,6.817,9.703,6.47,12.46,8.29c1.119-0.291,2.309-0.442,3.539-0.448   c1.234,0.006,2.423,0.157,3.543,0.448c2.756-1.82,4.08-1.473,4.226-1.426c0.143,0.046,0.257,0.153,0.312,0.292   c0.715,1.813,0.456,3.251,0.247,3.927c0.944,1.133,1.422,2.482,1.422,4.016c0,5.595-3.308,7.078-6.185,7.559   c0.354,0.623,0.549,1.426,0.549,2.32c0,1.013-0.005,2.465-0.01,3.692c0,0.166,0.077,0.315,0.214,0.412   c0.137,0.096,0.306,0.119,0.463,0.063C26.295,27.141,30,21.858,30,16c0-3.863-1.54-7.46-4.335-10.129   c-2.794-2.667-6.462-4.037-10.336-3.855c-0.275,0.021-0.509-0.201-0.523-0.476c-0.013-0.276,0.2-0.51,0.476-0.523   c4.152-0.19,8.08,1.274,11.073,4.131C29.351,8.007,31,11.861,31,16c0,6.277-3.97,11.937-9.878,14.084   c-0.463,0.167-0.978,0.099-1.38-0.185c-0.401-0.283-0.64-0.744-0.638-1.233c0.005-1.226,0.01-2.676,0.01-3.688   c0-1.459-0.567-2.107-0.811-2.317c-0.15-0.13-0.21-0.337-0.151-0.526c0.059-0.19,0.225-0.327,0.422-0.349   c3.054-0.34,6.176-1.401,6.176-6.686c0-1.38-0.458-2.582-1.36-3.569c-0.13-0.143-0.167-0.347-0.094-0.526   c0.139-0.34,0.524-1.537-0.042-3.198c-0.423,0.012-1.503,0.189-3.34,1.44c-0.122,0.083-0.274,0.109-0.416,0.068   c-1.084-0.302-2.293-0.465-3.499-0.472c-1.218,0.006-2.395,0.165-3.494,0.472c-0.141,0.042-0.293,0.015-0.416-0.068   c-1.83-1.245-2.91-1.427-3.346-1.438c-0.563,1.661-0.177,2.855-0.039,3.196c0.072,0.179,0.036,0.383-0.094,0.525   c-0.904,0.991-1.362,2.192-1.362,3.57c0,5.282,3.115,6.35,6.162,6.697c0.196,0.022,0.361,0.158,0.42,0.347   c0.059,0.188,0.001,0.395-0.147,0.525c-0.224,0.197-0.621,0.672-0.756,1.64c-0.023,0.17-0.133,0.316-0.29,0.386   c-0.75,0.338-3.316,1.237-4.858-1.413c-0.011-0.019-0.525-0.921-1.444-1.186c0.326,0.218,1.077,0.852,1.631,2.265   c0.043,0.133,0.808,2.409,4.313,1.646c0.148-0.031,0.301,0.003,0.419,0.098c0.118,0.094,0.187,0.237,0.188,0.387l0.011,2.17   c0.002,0.491-0.237,0.955-0.641,1.239C12,30.082,11.698,30.176,11.393,30.176z" />
                    <g>
                      <g>
                        <g>
                          <g>
                            <g>
                              <g>
                                <path d="M7.543,4.552c0,0.275-0.225,0.5-0.5,0.5l0,0c-0.275,0-0.5-0.225-0.5-0.5l0,0         c0-0.275,0.225-0.5,0.5-0.5l0,0C7.318,4.052,7.543,4.276,7.543,4.552L7.543,4.552z" />
                              </g>
                            </g>
                          </g>
                        </g>
                      </g>
                    </g>
                  </g>
                </svg>
              </a>
            </div>
          </div>
        </div>
      ))
    }
  </div>
</div>

<style>
  @keyframes slide-from-bottom-projects {
    0% {
      visibility: visible;
    }

    100% {
      opacity: 1;
      transform: translateY(0);
      visibility: visible;
    }
  }
  .anim {
    animation: slide-from-bottom-projects 2s ease-in 0s 1 normal forwards;
  }
  #projects {
    width: 100%;
    padding: 0 5%;
    visibility: hidden;
    opacity: 0;
    transform: translateY(15px);
  }
  svg {
    fill: white;
    width: 45px;
    height: 45px;
    transition: all 0.5s;
  }
  svg:hover {
    transform: scale(1.2) translateY(-6px);
    fill: url("#grad-blue");
    cursor: pointer;
  }
  a {
    all: unset;
  }
  .links {
    width: 100%;
    display: flex;
    flex-direction: row;
    justify-content: space-evenly;
    align-items: center;
  }
  .wrapper {
    display: grid;
    grid-template-columns: repeat(auto-fill, 400px);
    grid-column-gap: 20px;
    grid-row-gap: 20px;
  }
  .projet {
    border: solid 1px white;
    aspect-ratio: 16/9;
    width: 100%;
    overflow: hidden;
    text-align: center;
    transition: all 0.5s;
    border-radius: 12px;
  }
  .projet:hover {
    cursor: pointer;
    transform: scale(1.05);
  }
  .projet:hover .placeholder {
    transform: translateY(-100%);
  }
  .projet:hover .text {
    transform: translateY(-100%);
  }
  .text {
    transition: all 0.5s;
    padding: 10px;
    width: 100%;
    height: 100%;
  }
  .text p,
  .text h3 {
    margin: 5px 0;
  }
  .projet:active {
    transform: scale(0.95);
  }
  .placeholder {
    width: 100%;
    transition: all 0.5s;
  }
  .placeholder img {
    width: 100%;
    height: auto;
  }
  @media only screen and (max-width: 1220px) {
    .wrapper {
      grid-template-columns: repeat(1, 1fr);
    }
  }
</style>
